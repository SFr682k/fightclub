\documentclass[11pt]{ltxdoc}

\usepackage{fontspec}
\usepackage{unicode-math}
\usepackage{polyglossia}
\setdefaultlanguage{english}
\usepackage[english]{selnolig}

\setmainfont{Free Serif}
\setmathfont{XITS Math}
\setsansfont[Scale=MatchLowercase]{Free Sans}
\setmonofont[Scale=MatchLowercase]{Hack}

\usepackage[DIV=9]{typearea}

\usepackage{array}
\usepackage{csquotes}
\usepackage{enumitem}
    \setlist{itemsep=0ex,topsep=.5ex}
    
\usepackage{titlesec}
    \titleformat*{\paragraph}{\itshape}
    
\usepackage[table]{xcolor}


\usepackage{imakeidx}
    \indexprologue[\smallskip]{%
        This small index contains a selected number of important self-defined keywords and symbols. \\
        They are defined, explained and \colorbox{red!15}{highlighted} on the stated page.}
\usepackage[unicode, pdfborder={0 0 0}, hyperindex=true, linktoc=all, pdfpagelabels]{hyperref}


\def\highlight#1{%
    \colorbox{red!15}{#1}%
    \index{\textsf{#1}}}

\newlength{\ccharwidth}
\settowidth{\ccharwidth}{\texttt{~~~}}
\def\contindic{\hbox to \ccharwidth {\rmfamily\small\hookrightarrow}}
\def\tab{\hbox to \ccharwidth {{\rmfamily\small\mapsto}}}
\hbadness=10000


\MakeShortVerb{"}
\makeindex

\parindent 0pt

\hyphenation{spe-ci-fy-ing}

\hypersetup{pdftitle={Fightclub: Requirements on files}, pdfauthor={Sebastian Friedl}}





\title{\bfseries Fightclub: Requirements on files}
\author{Sebastian Friedl}
\date{\itshape Written to match the requirements of \\
      Fightclub Department 0.6 \\
      Fightclub Dashboard 0.3}

\begin{document}
    \maketitle
    
    \begin{abstract}\noindent
        Most Fightclub applications use plain text files for loading data. They can be created and edited using a common text editor. This document describes the syntactical requirements on such data files.
    \end{abstract}

    \tableofcontents

    
    
    
    
    \clearpage
    \section{General notes}
    This section introduces the principles of data files and IDs.
    Since most Fightclub applications depend on these mechanisms, knowledge about them is vital.
    
    \subsection{General requirements on files}
    Fightclub applications use plain text files for loading data. They can be created and edited using a common text editor; however, those files require use of the respective file extension listed in sections~\ref{sec:files-stages}ff and have to be encoded \textit{according to the favor of your operating system}; i.e.~"UTF-8" without Byte Order Mark on recent LINUX systems and "ANSI" on Windows systems (actually, "ANSI" is not an encoding, but references to the current codepage).

    \medskip
    To avoid loading wrong files -- and the resulting malfunction -- a \highlight{file header}, consisting of some "XML"-styled code, may be added to the first lines of each data file:
    
    \smallskip
    "<FightclubExchangeFile>stages</FightclubExchangeFile>" \\
    "<ExchangeProtocolVersion>1</ExchangeProtocolVersion>" \\
    "<ExchangeFileTitle>Stages for some tournament</ExchangeFileTitle>" \\
    "<ExchangeFileContentDescr>A short description</ExchangeFileContentDescr>"
    
    \bigskip
    \textbf{Note:}
    \begin{itemize}
        \item
            These tags are \textit{case sensitive}; for example, "<FightclubExchangeFile>" is recognized, while other variations like "<FIGHTCLUBexchangefile>" are not.
        \item
            Line breaks inside a tag are \textit{not} allowed; the whole tag has to be opened and closed on the same line.
        
        \item
            The values of "<FightclubExchangeFile>" and "<ExchangeProtocolVersion>" depend on the respective exchange file.
    \end{itemize} 
    
    \medskip
    As long as not being stated otherwise, \highlight{\mapsto} represents a tabstopp and \highlight{\hookrightarrow} a continuation of the previous line. It is \textit{not} possible to use spaces for indentation.
    
    
    
    \subsection{Two flavours of IDs}\label{sec:notes-id}
    Fightclub Department uses IDs for referencing to teams or participants. Those IDs are derived from the "teams" file (if present; see section~\ref{sec:files-teams}).
    
    \medskip
    There are two flavours of IDs:
    \begin{itemize}
        \item[a)] \textbf{Referencing teams: \highlight{Team IDs}} \\
            Team IDs consist of several arbitrary characters. There are only two limitations:
            \begin{itemize}
                \item[1.] Team IDs must \textit{not} contain the slash character ("/")
                \item[2.] All team IDs must be unique
            \end{itemize}
            
            Although you may use any character defined in your encoding (excluding the slash) for composing a team ID, it is recommended to use \enquote{only} latin letters (upper- and lowercase), numbers, underscores and \enquote{common} symbols to be on the safe side.
            
            \smallskip
            Examples for valid team IDs:\quad "foobar", "themysteryof237", "maschendrahtzaun" \\
            Invalid team IDs are:\quad "08/15", "here/there", "pe/\k", "____/\_______\o/_____"

        
        \item[b)] \textbf{Referencing participants: \highlight{Personal IDs}} \\
            Personal IDs consist of a team ID and a slash ("/") followed by an integer number. The integer number is determined by the position of the participant in his team's list of participants (see section~\ref{sec:files-teams}).
            
            \smallskip
            Examples for valid personal IDs:\quad "#lolblub42/1", "foobaz/5", "holzpfosten/2" \\
            Invalid personal IDs are:\quad "voo/doo", "invalid/23.7", "not/a/personal/id"
    \end{itemize}

    
    
    
    
    \clearpage
    \section{Files required by Fightclub Department}
    \subsection{Files specifying stages}\label{sec:files-stages}
    \begin{center}
        \rowcolors{1}{black!20}{white}
        \begin{tabular}{lr}
            File extension              & ".fcstages" \\
            "<FightclubExchangeFile>"   & "stages" \\
            "<ExchangeProtocolVersion>" & "1"
        \end{tabular}
    \end{center}
    
    
    There are two kinds of stages: stages of a physics fight and so-called \highlight{roomclock stages}, like an address of welcome or a lunch break. \\
    For each \textit{stage of a physics fight}, the list of phases will be gone through in the specified order while \textit{roomclock stages} only display their label without going through any phases.

    
    \subsubsection*{Syntax for physics fight stages}
    The syntax of a physics fight stage depends on the roles involved in it. It is
    \begin{center}\ttfamily
        stage label  \tab problem  \tab rep. id  \tab opp. id  \tab rev. id
    \end{center}
    for stages featuring all roles (Reporter, Opponent, Reviewer),
    \begin{center}\ttfamily
        stage label  \tab problem  \tab rep. id  \tab opp. id
    \end{center}
    for stages without reviewer and
    \begin{center}\ttfamily
        stage label  \tab problem  \tab rep. id
    \end{center}
    for stages with only a reporter.
    
    
    \paragraph{Key:}
    \begin{itemize}
        \item
            "stage label": should be used to indicate physics fight, room and stage nr (e.g. "PF 3/D1" for stage 1 of physics fight 3 in room D or just a simple time like "09:00")
        \item
            "problem": either the problem's number as stated in the "problems" file or "-1" (when specifying "-1", an arbitrary problem may be selected via the provided combo box)
 
        \item
            "rep. id", "opp. id", "rev. id": either the \textit{team id} of the reporting, opposing or reviewing team or the \textit{personal id} of the Reporter, Opponent or Reviewer
    \end{itemize}
    
    \medskip
    Please mind the difference between a \textit{stage} and a \textit{physics fight:} \\
    If there are three teams participating in a physics fight, there have to be three stages -- and therefore at least three lines in the stages file.
    
    \bigskip
    Teams with the Observer's role are not listed in such a stages file. \\
    Example for a four-team-fight between "hun", "pol", "chn" and "sgp" with an observer: \\[\smallskipamount]
    \begin{ttfamily}%
        \begin{tabular}{@{}l*{4}{>{\tab}l}}%
            Final/Stage 1 & 9  & hun & pol & chn \\
            Final/Stage 2 & 17 & pol & chn & sgp \\
            Final/Stage 3 & 3  & chn & sgp & hun \\
            Final/Stage 4 & 5  & sgp & hun & pol
        \end{tabular}
    \end{ttfamily}
    
    
    
    \subsubsection*{Syntax for roomclock stages}
    For specifying a roomclock stage, simply add a single-column line containing the stage's title to the stages file.
    
    
    \subsubsection*{Example lines for a \texttt{stages} file}
    \begin{ttfamily}%
        \begin{tabular}{@{}l*{4}{>{\tab}l}}%
            \multicolumn{5}{@{}l}{Address of Welcome} \\
            PF 3/D1 & -1 & ger    & cze~ & uk \\
            D 15:40 & 17 & aggr/2 & dch3 \\
            14:50   & 9  & wshp/4
        \end{tabular}
    \end{ttfamily}
    
    
    
    
    \subsection{Files specifying phases}
    \begin{center}
        \rowcolors{1}{black!20}{white}
        \begin{tabular}{lr}
            File extension              & ".fcphases" \\
            "<FightclubExchangeFile>"   & "phases" \\
            "<ExchangeProtocolVersion>" & "1"
        \end{tabular}
    \end{center}
    
    
    \subsubsection*{General syntax}
    \begin{center}\ttfamily
        duration  \tab overtime  \tab title  \tab performances  \tab options
    \end{center}
    
    \paragraph{Key:}
    \begin{itemize}
        \item "duration": the maximum duration of the phase in seconds
        \item "overtime": the maximum allowed overtime in seconds
        \item "title": the title of the phase as displayed
        \item "performances": the roles performing during this phase
        \item "options": further configuration of the phase
    \end{itemize}

    \medskip
    You may omit
    \begin{itemize}
        \item
            the "options" column or
        \item
            the "performances" column together with the "options" column, but \textit{not} the "performances" column alone.
    \end{itemize}
    
    \smallskip
    Lines consisting of less than three tabular-separated columns are ignored.

    
    \subsubsection*{Allowed values for \texttt{performances}}
    \begin{itemize}
        \item "rep": the Reporter is performing during the current phase
        \item "opp": the Opponent is performing during the current phase
        \item "rev": the Reviewer is performing during the current phase
        \item "nll": none of the three listed above are performing in the current phase
    \end{itemize}

    You have to specify \textit{at least one} of these values, including "nll". Values can be combined, e.g. one may use "repopp" for the discussion phase.

    \subsubsection*{Allowed \texttt{options}}
    \begin{itemize}
        \item "a": autoadvance to the next phase if maximum duration \textit{and} allowed overtime elapsed
        \item "c": carry the \textit{whole elapsed time} to the next phase
        \item "o": carry the \textit{elapsed overtime} to the next phase
        \item "r": roomclock phase; use this option only for phases where elapsed time and maximum duration are not relevant (e.g. breaks)
        \item "n": do not use any \enquote{special} options and behave like a \enquote{normal} phase
    \end{itemize}

    Again, you have to specify \textit{at least one} of these values, including "n".
    
    
    \subsubsection*{Example lines for a \texttt{phases} file}
    \begin{ttfamily}
        \begin{tabular}{@{}l*{4}{>{\tab}l}}%
            720 & 0 & Presentation of the report               & rep    & n \\
            240 & 0 & The Opponent takes the floor             & opp    & c \\
            840 & 0 & Discussion between Reporter and Opponent & repopp & n \\
            120 & 0 & Preparation of the Reviewer              & rev    & n \\
            600 & 0 & Break                                    & nll    & r
        \end{tabular}
    \end{ttfamily}
    
    
    
    
    \subsection{Files specifying problems}
    \begin{center}
        \rowcolors{1}{black!20}{white}
        \begin{tabular}{lr}
            File extension              & ".fcproblems" \\
            "<FightclubExchangeFile>"   & "problems" \\
            "<ExchangeProtocolVersion>" & "1"
        \end{tabular}
    \end{center}
    
    
    \subsubsection*{General syntax}
    \begin{center}\ttfamily
        nr  \tab  title
    \end{center}

    The list should be sorted by problem numbers in ascending order.
    
    \paragraph{Key:}
    \begin{itemize}
        \item "nr": the number of the problem; requires an integer value larger than 0
        \item "title": the title of the problem
    \end{itemize}
    
    \smallskip
    Lines consisting of less than two tabular-separated columns are ignored.
    
    
    \subsubsection*{Example lines for a \texttt{problems} file}
    \begin{ttfamily}
        \begin{tabular}{@{}l>{\tab}l}%
            5  & Leidenfrost Stars \\
            10 & Pulling Glasses Apart \\
            12 & Torsion Gyroscope
        \end{tabular}
    \end{ttfamily}
    
    \bigskip
    This is only an extract; a full \texttt{problems} file should of course contain all 17 problems.
    
    
    
    
    \subsection{Files specifying teams}\label{sec:files-teams}
    \begin{center}
        \rowcolors{1}{black!20}{white}
        \begin{tabular}{lr}
            File extension              & ".fcteams" \\
            "<FightclubExchangeFile>"   & "teams" \\
            "<ExchangeProtocolVersion>" & "1"
        \end{tabular}
    \end{center}
    
    
    \subsubsection*{General syntax}
    \begin{center}\ttfamily
        team id  \tab  team name  \tab  <list of participants>
    \end{center}

    \paragraph{Key:}
    \begin{itemize}
        \item "team id":
            the unique \textit{team id} (see section~\ref{sec:notes-id}) assigned to this team
        \item "team name":
            the name of the team (doesn't need not be unique)
        \item "<list of participants>":
            a tabstopp-separated list of all participants belonging to this team; may be omitted
    \end{itemize}
    
    \smallskip
    Lines consisting of less than two tabular-separated columns are ignored.
    
    
    \subsubsection*{Example lines for a \texttt{teams} file}
    \begin{ttfamily}
        \begin{tabular}{@{}l*{4}{>{\tab}l}}%
            ger & Germany     & R. Mason       & S. Friedl & W. El-Kishawi \\\multicolumn{2}{r@{}}{\contindic}
                              & B. Magnussen   & A. Medert \\
            cze & Czech Rep.  & P. Stepanek    & J. Domes  & D. Rychlý     \\\multicolumn{2}{r@{}}{\contindic}
                              & D. Wittek      & T. Wolf \\
            uk  & Un. Kingdom & J. Dranczewski & P. Cloud  & Y. Fei        \\\multicolumn{2}{r@{}}{\contindic}
                              & L. Jiao        & B. Miller
        \end{tabular}
    \end{ttfamily}
    
    \bigskip
    The following IDs are derived from this example:
    \begin{itemize}
        \item["ger"] \textbf{Team ID}
            representing an arbitrary member of team \texttt{Germany}, i.e. \texttt{R.~Mason}, \texttt{S.~Friedl}, \texttt{W.~El-Kishawi}, \texttt{B.~Magnussen} or \texttt{A.~Medert}.
            When such a Team ID is used in a "stages" file, one of the team's members may be selected via the provided combo boxes.
        
        \item["ger/1"] \textbf{Personal ID}
            representing member \texttt{1} of team \texttt{Germany}, i.e. \texttt{R.~Mason}
        
        \item["ger/3"] \textbf{Personal ID}
            representing member \texttt{3} of team \texttt{Germany}, i.e. \texttt{W. El-Kishawi}
        
        \item["ger/7"] \textbf{Invalid personal ID}
            since team \texttt{Germany} consists of five members
    \end{itemize}
    
    
    
    
    
    \clearpage
    \section{Files required by Fightclub Dashboard}
    \subsection{Files specifying a list of Departments}
    \begin{center}
        \rowcolors{1}{black!20}{white}
        \begin{tabular}{lr}
            File extension              & ".fcdeps" \\
            "<FightclubExchangeFile>"   & "departments" \\
            "<ExchangeProtocolVersion>" & "1"
        \end{tabular}
    \end{center}
    
    
    \subsubsection*{General syntax}
    \begin{center}\ttfamily
        port  \tab  id  \tab  label
    \end{center}

    \paragraph{Key:}
    \begin{itemize}
        \item "port": the port the department's status is broadcasted to
        \item "id": the department's ID
        \item "label": the label to be displayed in Fightclub Dashboard
    \end{itemize}
    
    \smallskip
    Lines consisting of less than three tabular-separated columns are ignored.
    
    \medskip
    Each Fightclub Dashboard broadcasting to the network or a custom IP address has to use a unique "port"/"ID" combination.
    Therefore, using Fightclub's standard broadcast "port"/"ID" combination ("45454"/"12345") should be avoided.
    
    
    \subsubsection*{Example lines for a \texttt{departments} file}
    \begin{ttfamily}
        \begin{tabular}{@{}l*{4}{>{\tab}l}}%
            3030 & 12649 & Room A \\
            4040 & 31080 & Room B \\
            5050 & 41123 & Room C
        \end{tabular}
    \end{ttfamily}
    
    
    
    
    
    
    \printindex
    \phantomsection
    \addcontentsline{toc}{section}{Index}
\end{document}


